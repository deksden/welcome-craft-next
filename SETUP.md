# SETUP.md :: Руководство по Настройке Рабочего Окружения "WelcomeCraft"

**Версия документа:** 1.0.0
**Дата:** 2025-06-07

Этот документ содержит пошаговую инструкцию по настройке проекта "WelcomeCraft" на новой машине для разработки.

## 1. Предварительные требования

Перед началом убедитесь, что на вашей системе установлены следующие компоненты:

- **Node.js**: Рекомендуется версия `20.x` или выше (как указано в `lint.yml`).
- **pnpm**: Используется как менеджер пакетов. Установить можно командой `npm install -g pnpm`. Проект настроен на версию `pnpm@9.12.3`.
- **Git**: Для клонирования репозитория.
- **Vercel CLI**: Рекомендуется для удобного управления переменными окружения. Установить можно командой `npm install -g vercel`.

## 2. Начальная настройка проекта

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <адрес_вашего_репозитория>
    cd welcome-craft-next
    ```

2.  **Установите зависимости:**
    Проект использует `pnpm`. Выполните команду в корневой директории проекта:
    ```bash
    pnpm install
    ```
    Эта команда установит все необходимые зависимости, указанные в `package.json`.

## 3. Настройка переменных окружения

Для работы приложения требуются секретные ключи и URL для подключения к сервисам.

1.  **Создайте файл `.env.local`:**
    Скопируйте содержимое файла `.env.example` в новый файл с именем `.env.local`:
    ```bash
    cp .env.example .env.local
    ```

2.  **Заполните значения:**
    Откройте файл `.env.local` и вставьте ваши значения для каждой переменной.

    -   `AUTH_SECRET`: Секретный ключ для NextAuth.js. Можно сгенерировать командой `openssl rand -base64 32`.
    -   `POSTGRES_URL`: URL для подключения к вашей базе данных PostgreSQL (например, из Neon или Vercel Postgres).
    -   `BLOB_READ_WRITE_TOKEN`: Токен для доступа к Vercel Blob (хранилище файлов).
    -   `REDIS_URL`: URL для подключения к Redis (например, из Upstash или Vercel Redis). Используется для возобновляемых стримов AI SDK.
    -   `XAI_API_KEY`: Ваш API-ключ от xAI для доступа к языковым и генеративным моделям.

> **Важно:** Файл `.env.local` не должен попадать в систему контроля версий (Git), так как он содержит секретные данные. Он уже добавлен в `.gitignore`.

## 4. Запуск проекта для разработки

После выполнения всех предыдущих шагов вы готовы запустить проект.

-   **Запустите dev-сервер:**
    ```bash
    pnpm dev
    ```
    Приложение будет доступно по адресу `http://localhost:3000`.

## 5. Тестирование

Проект использует Playwright для E2E-тестов.

1.  **Установите браузеры для Playwright (при первом запуске):**
    ```bash
    pnpm exec playwright install --with-deps
    ```

2.  **Запустите тесты:**
    Убедитесь, что dev-сервер запущен, и выполните команду:
    ```bash
    pnpm test
    ```

## 6. Основные команды для разработки

-   `pnpm dev`: Запустить сервер для разработки.
-   `pnpm build`: Собрать production-версию приложения (также выполняет миграции БД).
-   `pnpm start`: Запустить production-сборку.
-   `pnpm lint`: Проверить код линтером.
-   `pnpm format`: Отформатировать код.
-   `pnpm test`: Запустить E2E-тесты.
-   `pnpm db:migrate`: Применить миграции базы данных.
-   `pnpm db:studio`: Открыть Drizzle Studio для просмотра и редактирования данных в БД.
-   `pnpm db:generate`: Сгенерировать файлы миграций после изменения схемы в `lib/db/schema.ts`.
