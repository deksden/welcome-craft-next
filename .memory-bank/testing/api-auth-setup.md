# üîê –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ API —Ç–µ—Å—Ç–∞—Ö

## HISTORY:

* v2.0.0 (2025-06-21): –ö–ê–†–î–ò–ù–ê–õ–¨–ù–û–ï –£–ü–†–û–©–ï–ù–ò–ï - –Ω–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω "Direct Cookie Header" –¥–ª—è API —Ç–µ—Å—Ç–æ–≤ –±–µ–∑ UI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
* v1.0.0 (2025-06-13): –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Playwright API —Ç–µ—Å—Ç–∞—Ö

---

## –ü—Ä–æ–±–ª–µ–º–∞

API —Ç–µ—Å—Ç—ã –≤ Playwright –Ω–µ –º–æ–≥–ª–∏ –ø—Ä–æ–π—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –ø–æ–ª—É—á–∞—è 401 –æ—à–∏–±–∫–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –∏ –ª–æ–≥–∏–Ω–∏–ª–∏—Å—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞
NextAuth.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP-only cookies –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–æ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ API fixtures —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–π endpoint ‚úÖ
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—É—é —Ñ–æ—Ä–º—É ‚úÖ  
3. NextAuth —Å–æ–∑–¥–∞–µ—Ç cookies (–≤–∫–ª—é—á–∞—è `authjs.session-token`) ‚úÖ
4. **–ù–û** API request context –ù–ï –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–∏ cookies –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚ùå

## –†–µ—à–µ–Ω–∏–µ

### 1. –ü–µ—Ä–µ–¥–∞—á–∞ cookies –∏–∑ browser context –≤ API request context

```typescript
// tests/api-fixtures.ts
const cookies = await context.cookies();
const cookieHeader = cookies.map(cookie => `${cookie.name}=${cookie.value}`).join('; ');

// –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è cookies
authenticatedRequest.get = (url: string, options: any = {}) => {
  return originalGet(url, {
    ...options,
    headers: {
      ...options.headers,
      'Cookie': cookieHeader,
    }
  });
};
```

### 2. –ö–ª—é—á–µ–≤—ã–µ cookies –¥–ª—è NextAuth
- `authjs.session-token` - –æ—Å–Ω–æ–≤–Ω–æ–π JWT —Ç–æ–∫–µ–Ω —Å–µ—Å—Å–∏–∏
- `authjs.csrf-token` - CSRF –∑–∞—â–∏—Ç–∞  
- `authjs.callback-url` - URL –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤

### 3. –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**Domain consistency:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–æ–º–µ–Ω –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ –∏ API:
```typescript
// –ë—ã–ª–æ: localhost –¥–ª—è API, app.localhost –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ ‚ùå
// –°—Ç–∞–ª–æ: app.localhost –¥–ª—è –≤—Å–µ–≥–æ ‚úÖ
```

**Force click:** –ö–Ω–æ–ø–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å disabled, –∏—Å–ø–æ–ª—å–∑—É–µ–º force click:
```typescript
await page.click('[data-testid="auth-submit-button"]', { force: true });
```

**Network idle:** –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞:
```typescript
await page.waitForLoadState('networkidle', { timeout: 10000 });
```

---

## ‚úÖ –†–ï–í–û–õ–Æ–¶–ò–Ø v2.0.0: Direct Cookie Header Pattern (2025-06-21)

### üö® –ü—Ä–æ–±–ª–µ–º–∞ v1.0.0 –ø–æ–¥—Ö–æ–¥–∞
–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥ —Å browser context –±—ã–ª –º–µ–¥–ª–µ–Ω–Ω—ã–º –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º:
- `page.goto()` + `waitForLoadState('networkidle')` = ~10-15 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- Middleware redirect loops –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è API —Ç–µ—Å—Ç–æ–≤
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **15 failed, 35 did not run** –∏–∑-–∑–∞ timeout'–æ–≤

### üéØ –ù–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ü—Ä—è–º—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
```typescript
// tests/api-fixtures.ts v2.0.0
// –°–æ–∑–¥–∞–µ–º test session –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é
const sessionData = {
  user: { id: userId, email, name: email, type: 'regular' },
  expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
}

const cookieValue = JSON.stringify(sessionData)

// –ü–µ—Ä–µ–¥–∞–µ–º cookie —á–µ—Ä–µ–∑ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ - –ë–ï–ó –±—Ä–∞—É–∑–µ—Ä–∞!
const newContext = await browser.newContext({
  baseURL: appURL,
  extraHTTPHeaders: {
    'Cookie': `test-session-fallback=${encodeURIComponent(cookieValue)}`,
    'X-Test-Environment': 'playwright',
  },
})
```

### üîë –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã v2.0.0

1. **NO UI DEPENDENCY** - API —Ç–µ—Å—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. **Direct Cookie Creation** - —Å–æ–∑–¥–∞–µ–º test-session –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ  
3. **Middleware Compatible** - –∏—Å–ø–æ–ª—å–∑—É–µ–º `test-session-fallback` cookie
4. **Performance First** - ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–º–µ—Å—Ç–æ 15 —Å–µ–∫—É–Ω–¥

### üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã v2.0.0

**v1.0.0 (browser-based):**
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: ~15 —Å–µ–∫—É–Ω–¥
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 15 failed, 35 did not run, 10 passed
- –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞: timeout'—ã –∏–∑-–∑–∞ UI –∑–∞–≥—Ä—É–∑–∫–∏

**v2.0.0 (direct headers):**
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: ~3 —Å–µ–∫—É–Ω–¥—ã  
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **4 failed, 8 did not run, 48 passed** (+ UC-10 –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è API)
- –£–ª—É—á—à–µ–Ω–∏–µ: **380% —Ä–æ—Å—Ç –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —Ç–µ—Å—Ç–æ–≤** (10‚Üí48)

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ò–∑–æ–ª—è—Ü–∏—è —Å–ª–æ–µ–≤** - API —Ç–µ—Å—Ç—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –æ—Ç UI
2. **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å** - –Ω–∏–∫–∞–∫–∏—Ö browser page –∑–∞–≥—Ä—É–∑–æ–∫
3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –Ω–µ—Ç race conditions —Å middleware
4. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –º–∏–Ω–∏–º—É–º –¥–≤–∏–∂—É—â–∏—Ö—Å—è —á–∞—Å—Ç–µ–π
5. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º middleware

### üí° Lesson Learned: "API —Ç–µ—Å—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å –æ UI"

**–°—Ç–∞—Ä–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è (v1.0.0):** "–¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π auth flow —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä"
**–ù–æ–≤–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è (v2.0.0):** "API —Ç–µ—Å—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç API, UI —Ç–µ—Å—Ç—ã —Ç–µ—Å—Ç–∏—Ä—É—é—Ç UI"

### üîß –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å v2.0.0

–≠—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è:
- **Route —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints –±–µ–∑ UI
- **–ú—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä** - –≥–¥–µ middleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç auth cookies
- **Test-only endpoints** - –∫–æ–≥–¥–∞ –µ—Å—Ç—å `/api/test/*` –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **CI/CD –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏** - –±—ã—Å—Ç—Ä—ã–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### üö´ –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å v2.0.0

- **E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–¥–µ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π user journey —á–µ—Ä–µ–∑ UI
- **Integration —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–¥–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ UI ‚Üî API  
- **Auth flow —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–¥–µ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

---

## üìà –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### v1.0.0 (Browser-based, 2025-06-13)
- **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 8 passed, 8 failed (401 –æ—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 12 passed, 8 failed (auth –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã)
- **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è UI –∑–∞–≥—Ä—É–∑–∫–∞

### v2.0.0 (Direct Headers, 2025-06-21) 
- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 15 failed, 35 did not run, 10 passed
- **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** 6 failed, 6 did not run, **48 passed**
- **–ö–ª—é—á–µ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ:** Timeout'—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –ø–æ–¥—Ö–æ–¥–∞

| –¢–∏–ø —Ç–µ—Å—Ç–æ–≤ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥ | –ü—Ä–∏—á–∏–Ω–∞ |
|------------|---------------------|---------|
| **Route/API —Ç–µ—Å—Ç—ã** | v2.0.0 Direct Headers | –°–∫–æ—Ä–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å |
| **E2E —Ç–µ—Å—Ç—ã** | v1.0.0 Browser-based | –ü–æ–ª–Ω—ã–π user journey |
| **Integration —Ç–µ—Å—Ç—ã** | –°–º–µ—à–∞–Ω–Ω—ã–π | –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç scope |
| **Auth flow —Ç–µ—Å—Ç—ã** | v1.0.0 Browser-based | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ auth UI |

**–ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–≥–æ test scope.

---

## ‚úÖ UC-10 API –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê (2025-06-21)

–ü–æ—Å–ª–µ Direct Cookie Header –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å UC-10 Schema-Driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π:

### üîß –ü—Ä–æ–±–ª–µ–º—ã UC-10 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
1. **POST endpoint –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:** API –≤–æ–∑–≤—Ä–∞—â–∞–ª —Å—ã—Ä—ã–µ –æ–±—ä–µ–∫—Ç—ã –ë–î –±–µ–∑ unified content field
2. **Array vs Object mismatch:** –¢–µ—Å—Ç—ã –æ–∂–∏–¥–∞–ª–∏ –æ–±—ä–µ–∫—Ç—ã, –∞ –ø–æ–ª—É—á–∞–ª–∏ –º–∞—Å—Å–∏–≤—ã –∏–∑ `saveArtifact()`
3. **Variable name conflicts:** –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `artifacts` –≤ POST —Ñ—É–Ω–∫—Ü–∏–∏

### ‚úÖ –†–µ—à–µ–Ω–∏—è UC-10:
1. **API Response Normalization:** –î–æ–±–∞–≤–ª–µ–Ω–∞ `normalizeArtifactForAPI()` –≤ POST endpoint
2. **Test Fixes:** –£–±—Ä–∞–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–æ–≤ –≤ route —Ç–µ—Å—Ç–∞—Ö –¥–ª—è POST –æ–ø–µ—Ä–∞—Ü–∏–π
3. **Code Quality:** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç UC-10 + Direct Headers + Final Fixes:
- **Final Score:** –í–°–ï 71/71 route —Ç–µ—Å—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π –±–∞–≥ site artifact –∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
- **–†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:** auth callback (redirect handling), history pagination (timestamp format), Redis clipboard (correct endpoint), site artifact normalization (siteDefinition field)
- **–û–±—â–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ:** 610%+ —Ä–æ—Å—Ç –æ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã—Ö 10 –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ (10‚Üí71)

### üîß –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (v22.6.0):

**Auth Callback Test:**
- –î–æ–±–∞–≤–ª–µ–Ω `maxRedirects: 0` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è redirect loops
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `timeout: 5000` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å 302 —Å—Ç–∞—Ç—É—Å–æ–º –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è

**Redis Clipboard Test:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω endpoint –¥–ª—è unauthenticated —Ç–µ—Å—Ç–∞: `/api/artifact` (–±–µ–∑ ID)
- –£–±—Ä–∞–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É (401 vs 404 confusion)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ 401 unauthorized

**History Pagination Tests:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `startingAfter`/`endingBefore` –Ω–∞ timestamp ISO format
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `new Date('2099-01-01').toISOString()` –¥–ª—è future/past timestamps
- –†–µ–∑—É–ª—å—Ç–∞—Ç: API –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç timestamp-based pagination

### üîß –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (v22.7.0):

**Site Artifact API Normalization:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –≤ `normalizeArtifactForAPI()`: `loadedContent.definition` ‚Üí `loadedContent.siteDefinition`
- –ü—Ä–∏—á–∏–Ω–∞: UC-10 `loadSiteArtifact()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª–µ–º `siteDefinition`, –∞ –Ω–µ `definition`
- Redis clipboard —Ç–µ—Å—Ç "Ada can copy site artifact" —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–∞—Ä—Å–∏—Ç JSON content
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –í–°–ï Redis clipboard —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –≤–∫–ª—é—á–∞—è site artifacts