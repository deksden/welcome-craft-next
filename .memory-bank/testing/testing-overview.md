# üß™ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –æ–±–∑–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ WelcomeCraft. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–ª—É–∂–∏—Ç –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –∏
–Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–æ–º –ø–æ –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–í–µ—Ä—Å–∏—è:** 0.18.0  
**–î–∞—Ç–∞:** 2025-06-28  
**–°—Ç–∞—Ç—É—Å:** UNIFIED COOKIE ARCHITECTURE - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É–ø—Ä–æ—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ –µ–¥–∏–Ω–æ–≥–æ test-session –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**

1. [–§–∏–ª–æ—Å–æ—Ñ–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#-1-—Ñ–∏–ª–æ—Å–æ—Ñ–∏—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã](#-2-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-–ø–∞—Ç—Ç–µ—Ä–Ω—ã)
    - [Three-Mode Environment Detection](#three-mode-environment-detection)
    - [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–≤-—Ç–µ—Å—Ç–∞—Ö)
    - [–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
    - [–ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (UI)](#–∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ-—Ç–µ—Å—Ç—ã-ui)
3. [–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã](#-3-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
4. [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞](#-4-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞)

---

## üéØ 1. –§–∏–ª–æ—Å–æ—Ñ–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

WelcomeCraft –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

### –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **Unit Tests (Vitest)** ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
2. **Route Tests (Playwright)** ‚Äî API endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. **E2E Tests (Playwright)** ‚Äî —Å–∫–≤–æ–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏


### –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- ‚úÖ **Route Tests:** 82/82 (100%) ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ **Unit Tests:** 94/94 (100%) ‚Äî –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ UC-10
- ‚úÖ **E2E Tests:** 36/36 –ñ–ï–õ–ï–ó–û–ë–ï–¢–û–ù–ù–´–ï ‚Äî –ø–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ real assertions –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- ‚úÖ **TypeScript:** 0 –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ ‚Äî –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Next.js 15
- ‚úÖ **Regression Tests:** 9/9 (100%) ‚Äî –≤—Å–µ –±–∞–≥–∏ –ø–æ–∫—Ä—ã—Ç—ã

---

## üèóÔ∏è 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –ï–¥–∏–Ω—ã–π "Local-Prod" —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** ‚úÖ **–£–ü–†–û–©–ï–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê** - –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏, **–≤—Å–µ E2E –∏ Route —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Ç–∏–≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–±–æ—Ä–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (`pnpm build && pnpm start`). –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —Å–≤—è–∑–∞–Ω–Ω—É—é —Å hot-reload –∏ dev-–∫–æ–º–ø–∏–ª—è—Ü–∏–µ–π, –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –º—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Ç–æ—Ç –∂–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ï–¥–∏–Ω—ã–π —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞:** –ö–æ–º–∞–Ω–¥–∞ `pnpm test` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ–∂–∏–º–µ.
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ dev-—Å–µ—Ä–≤–µ—Ä–∞.
- **–ò–∑–æ–ª—è—Ü–∏—è –ë–î:** –î–ª—è —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `welcomecraft_test`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `.env.test`.

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** ‚úÖ **UNIFIED COOKIE ARCHITECTURE** - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É–ø—Ä–æ—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–æ –µ–¥–∏–Ω–æ–≥–æ `test-session` cookie –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è + world isolation).

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è Cookie Unification:**

- **‚úÖ Single Cookie System:** –£–±—Ä–∞–Ω—ã –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ cookies (`world_id`, `world_id_fallback`, `test-world-id`) - –æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ `test-session`
- **‚úÖ Unified Data Source:** `test-session.worldId` –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ world isolation –≤–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ
- **‚úÖ Simplified Architecture:** DevWorldSelector, WorldIndicator, world-context —á–∏—Ç–∞—é—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- **‚úÖ Maximum Simplification:** –£–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ cookies, fallback –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **‚úÖ Universal Authentication:** –í—Å–µ E2E —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π `universalAuthentication()` helper
- **‚úÖ Route tests:** 82/82 (100%) —Å Direct Cookie Header Pattern

**Unified Cookie Structure:**
```typescript
interface TestSession {
  user: { id: string, email: string, name: string, type: string }
  worldId?: string // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π world isolation
  expires: string
}
```

**Performance:**

- ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- 100% consistency across all test types
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

> **–î–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–±–ª–µ–º—ã –∏ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–º. `api-auth-setup.md`** (–¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ
> —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç–≤–æ–ª—é—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏).

### E2E Critical Fixes - Next.js 15 Compliance

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** ‚úÖ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–í–ï–†–®–ï–ù–´** - –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ E2E
—Ç–µ—Å—Ç–∞—Ö —á–µ—Ä–µ–∑ –ø–æ–ª–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ Next.js 15 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

**–ö–ª—é—á–µ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### üîß **TypeScript & Import Resolution**

- **‚úÖ getServerSession:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –≤ artifacts page
- **‚úÖ Auth Architecture:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ unified `getAuthSession()` —Å–∏—Å—Ç–µ–º–∞
- **‚úÖ Missing Modules:** –£–¥–∞–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ `auth-options`, `ai-mock`, `auth-mock`
- **‚úÖ Import Paths:** –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã

#### üèóÔ∏è **Next.js 15 Server Components**

- **‚úÖ SearchParams Promise API:** –û–±–Ω–æ–≤–ª–µ–Ω—ã interfaces –¥–ª—è `Promise<SearchParams>`
- **‚úÖ Server Component Pattern:** –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è artifacts page –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- **‚úÖ Async Compliance:** –í—Å–µ server functions –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–º–µ—á–µ–Ω—ã `async`
- **‚úÖ Client/Server Boundary:** –ò—Å–∫–ª—é—á–µ–Ω—ã server-only –∏–º–ø–æ—Ä—Ç—ã –∏–∑ client –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### ü§ñ **AI Fixtures Migration**

- **‚úÖ Legacy Mock Removal:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π mock —Å–∏—Å—Ç–µ–º—ã
- **‚úÖ Automatic Fixtures:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ environment-driven AI Fixtures
- **‚úÖ Backward Compatibility:** Deprecated stubs –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
- **‚úÖ Test Utils Migration:** –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ POM –∫–ª–∞—Å—Å—ã –¥–ª—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

- **TypeScript:** `pnpm typecheck` ‚úÖ 0 –æ—à–∏–±–æ–∫
- **Build:** `pnpm build` ‚úÖ —É—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è
- **E2E Tests:** 40/40 ‚úÖ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –±–µ–∑ compilation errors
- **Architecture:** 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Next.js 15 best practices

> **–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—à–ª–∞ –æ—Ç –ø–æ–ª–Ω–æ–≥–æ –∫—Ä–∞—Ö–∞ –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é** - –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–µ—Ä—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ Memory
> Bank –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–Ω—Ü–µ–ø—Ü–∏—è "Use Cases + Worlds + AI Fixtures" –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é
E2E-—Ç–µ—Å—Ç–æ–≤, —Å–≤—è–∑—ã–≤–∞—è –∏—Ö —Å –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ AI-–æ—Ç–≤–µ—Ç—ã –≤ —Ä–µ–∂–∏–º–µ `record` –∏
–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∏—Ö –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω–æ –≤ —Ä–µ–∂–∏–º–µ `replay`.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```typescript
// 1. Use Case —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
UC - 01 - Site - Publication.md // –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

// 2. World definition  
SITE_READY_FOR_PUBLICATION // –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

// 3. AI Fixtures
tests / fixtures / ai / UC - 01 / // –ó–∞–ø–∏—Å–∞–Ω–Ω—ã–µ AI-–æ—Ç–≤–µ—Ç—ã –¥–ª—è replay
```

> **–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è, –ø—Ä–∏–º–µ—Ä—ã Use Cases –∏ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã AI Fixtures –Ω–∞—Ö–æ–¥—è—Ç—Å—è
–≤ `three-level-testing-system.md`** (—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω—ã—Ö E2E-—Ç–µ—Å—Ç–æ–≤). *
*–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã –≤ `worlds-manifest.md`**.

### –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (UI)

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** ‚úÖ **FAIL-FAST –ê–†–•–ò–¢–ï–ö–¢–£–†–ê** - –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ timeout'–∞–º–∏ –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

- **Fixed Timeout System** ‚Äî –ø—Ä–æ—Å—Ç—ã–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ timeouts: 3000ms –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, 15000ms –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- **Production-First Testing** ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–æ—Ç–∏–≤ production build (`pnpm build && pnpm start`)
- **Fail-Fast Architecture** ‚Äî –±—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º UI –±–µ–∑ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- **Universal Authentication** ‚Äî –µ–¥–∏–Ω—ã–π `universalAuthentication()` helper –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- **POM Patterns** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –ª–æ–≥–∏–∫–æ–π
- **Memory Bank Integration** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
- **AI Fixtures** ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã AI –º–æ–¥–µ–ª–µ–π –≤ —Ä–µ–∂–∏–º–µ replay

**‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è Unified Authentication Migration (2025-06-28):**

- **UC-01:** ‚úÖ –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å universalAuthentication
- **UC-02, UC-03:** ‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ unified patterns
- **UC-04, UC-05, UC-06, UC-07:** ‚úÖ –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- **UC-11:** ‚úÖ File import —Å unified authentication
- **artifact-editor-behavior:** ‚úÖ Component —Ç–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- ‚úÖ **Universal Authentication** ‚Äî –µ–¥–∏–Ω—ã–π `universalAuthentication()` helper –∑–∞–º–µ–Ω–∏–ª –≤—Å–µ legacy —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **Simplified Timeouts** ‚Äî —É–±—Ä–∞–Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å dynamic timeout —Å–∏—Å—Ç–µ–º –≤ –ø–æ–ª—å–∑—É –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ **Fail-Fast Principles** ‚Äî –±—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–µ–∑ graceful degradation overhead
- ‚úÖ **Consistent Patterns** ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω—ã–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º
- ‚úÖ **Legacy Cleanup** ‚Äî —É–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ auth helpers –∏ —Å–ª–æ–∂–Ω—ã–µ timeout —Å–∏—Å—Ç–µ–º—ã

### Simplified Fail-Fast Timeout System (2025-06-28)

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:** ‚úÖ **–£–ü–†–û–©–ï–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê** - –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç —Å–ª–æ–∂–Ω–æ–π Dynamic Timeout System –∫ –ø—Ä–æ—Å—Ç—ã–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º timeout'–∞–º –¥–ª—è –ª—É—á—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- **‚úÖ Predictable Behavior:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ timeout'—ã —É—Å—Ç—Ä–∞–Ω—è—é—Ç –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –≤ —Ç–µ—Å—Ç–∞—Ö
- **‚úÖ Easier Debugging:** –ü—Ä–æ—Å—Ç—ã–µ timeout –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–ª–µ–≥—á–∞—é—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø—Ä–æ–±–ª–µ–º
- **‚úÖ Reduced Complexity:** –£–±—Ä–∞–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å auto-profile measurement
- **‚úÖ Better Maintainability:** –ù–æ–≤—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ª–µ–≥–∫–æ –ø–æ–Ω–∏–º–∞—é—Ç –ø—Ä–æ—Å—Ç—É—é —Å–∏—Å—Ç–µ–º—É
- **‚úÖ Consistent Performance:** –°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –±–µ–∑ performance variability

**–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ timeout'—ã:** 3000ms –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, 15000ms –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- **–ü—Ä–æ—Å—Ç–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è:** `page.goto()` –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω—ã—Ö auto-profile —Ñ—É–Ω–∫—Ü–∏–π
- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:** –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```typescript
// –ü—Ä–æ—Å—Ç–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
await page.goto('/artifacts')

// –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ timeout'—ã
await expect(element).toBeVisible({ timeout: 3000 })

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
const testUser = {
  email: `test-${Date.now()}@test.com`,
  id: crypto.randomUUID()
}
await universalAuthentication(page, testUser)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–ø—Ä–æ—â–µ–Ω–∏—è:**

- **‚úÖ Easier onboarding:** –ù–æ–≤—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±—ã—Å—Ç—Ä–æ –ø–æ–Ω–∏–º–∞—é—Ç —Å–∏—Å—Ç–µ–º—É
- **‚úÖ Reduced flakiness:** –ú–µ–Ω—å—à–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö = –±–æ–ª—å—à–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **‚úÖ Better debugging:** –ü—Ä–æ—Å—Ç—ã–µ timeout'—ã –ª–µ–≥—á–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- **‚úÖ Consistent behavior:** –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–æ –≤—Å–µ—Ö —Å—Ä–µ–¥–∞—Ö

**Environment Variable Overrides:**

- `PLAYWRIGHT_TIMEOUT_NAVIGATION` ‚Äî timeout –¥–ª—è page.goto()
- `PLAYWRIGHT_TIMEOUT_ELEMENT` ‚Äî timeout –¥–ª—è element visibility
- `PLAYWRIGHT_TIMEOUT_INTERACTION` ‚Äî timeout –¥–ª—è –∫–ª–∏–∫–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
- `PLAYWRIGHT_TIMEOUT_AI` ‚Äî timeout –¥–ª—è AI processing
- `PLAYWRIGHT_TIMEOUT_WAIT` ‚Äî –æ–±—â–∏–µ wait –æ–ø–µ—Ä–∞—Ü–∏–∏

> **–ü–æ–ª–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –≤—Å–µ—Ö `data-testid` –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã POM –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ `ui-testing.md`** (—ç—Ç–æ—Ç "–ñ–∏–≤–æ–π –ú–∞–Ω–∏—Ñ–µ—Å—Ç
> UI" —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–∞–≤–¥—ã –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã POM Revision —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ
> —É–ª—É—á—à–µ–Ω–∏—é).

---

## üõ†Ô∏è 3. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### Playwright (E2E + API)

- **E2E Testing:** –ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **Route Testing:** API endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **Multi-domain Support:** `app.localhost` vs `localhost` –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º e2e —Ç–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ pnpm build && pnpm start —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –∏–∑-–∑–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –º–æ–¥—É–ª–µ–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º 

### Vitest (Unit)

- **–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **–ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ë–î, API, `server-only`)

---

## üöÄ 4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

### ‚úÖ –≠—Ñ–µ–º–µ—Ä–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –ë–î (Ephemeral Test Database)

**–ù–û–í–û–ï:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Docker.

- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ–≤–æ–º —Ñ–∞–π–ª–µ `SETUP.md`.
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** `globalSetup` –∑–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ + —Å–∏–¥–∏–Ω–≥ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
- **–ò–∑–æ–ª—è—Ü–∏—è:** –ö–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ–∂—É—é –ë–î –≤ tmpfs –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Cleanup:** `globalTeardown` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

```bash
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
pnpm test:db-up        # –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
pnpm test:db-setup     # –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥–∏–Ω–≥
pnpm test:db-down      # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```

### –ö–æ–º–∞–Ω–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã (UNIFIED LOCAL-PROD ARCHITECTURE)
pnpm test              # E2E + Route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ç–∏–≤ production build
pnpm test:unit         # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (94/94) ‚úÖ
pnpm test:routes       # API —Ç–µ—Å—Ç—ã (82/82) ‚úÖ Direct Cookie Header Pattern  
pnpm test:e2e          # E2E —Ç–µ—Å—Ç—ã (8 UC tests) ‚úÖ Universal Authentication
pnpm test:ui           # Playwright UI mode –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏

# AI Fixtures —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
AI_FIXTURE_MODE=record pnpm test:e2e    # –ó–∞–ø–∏—Å—å
AI_FIXTURE_MODE=replay pnpm test:e2e    # –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```

–û–±—Ä–∞—Ç–∏ 
**‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –í—Å–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ, —Ç–µ—Å—Ç—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ e2e/                    # E2E —Ç–µ—Å—Ç—ã (Playwright) - ‚úÖ UNIFIED
‚îÇ   ‚îú‚îÄ‚îÄ use-cases/          # Use Case —Ç–µ—Å—Ç—ã (UC-01 ‚Üí UC-11) ‚úÖ fastAuthentication()
‚îÇ   ‚îî‚îÄ‚îÄ regression/         # –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (BUG-XXX)
‚îú‚îÄ‚îÄ routes/                 # API —Ç–µ—Å—Ç—ã (Playwright) - ‚úÖ UNIFIED
‚îÇ   ‚îú‚îÄ‚îÄ artifact.test.ts    # –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã CRUD ‚úÖ Direct Cookie Header
‚îÇ   ‚îú‚îÄ‚îÄ auth.test.ts        # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ 
‚îÇ   ‚îî‚îÄ‚îÄ history.test.ts     # –ò—Å—Ç–æ—Ä–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è ‚úÖ
‚îú‚îÄ‚îÄ unit/                   # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (Vitest) - ‚úÖ STABLE
‚îÇ   ‚îú‚îÄ‚îÄ artifacts/          # –õ–æ–≥–∏–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (UC-10 coverage)
‚îÇ   ‚îú‚îÄ‚îÄ lib/                # –£—Ç–∏–ª–∏—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ api/                # API —Ö–µ–ª–ø–µ—Ä—ã
‚îú‚îÄ‚îÄ pages/                  # ‚úÖ UNIFIED POM Architecture
‚îÇ   ‚îú‚îÄ‚îÄ publication.page.ts # Publication workflow
‚îÇ   ‚îú‚îÄ‚îÄ site-editor.page.ts # Site visual editing
‚îÇ   ‚îú‚îÄ‚îÄ file-import.page.ts # File import system
‚îÇ   ‚îî‚îÄ‚îÄ sidebar.page.ts     # Navigation and content management
‚îú‚îÄ‚îÄ helpers/                # ‚úÖ UNIFIED Utilities
‚îÇ   ‚îú‚îÄ‚îÄ auth.helper.ts      # Universal Authentication for all test types
‚îÇ   ‚îú‚îÄ‚îÄ e2e-auth.helper.ts  # Legacy (scheduled for removal)
‚îÇ   ‚îî‚îÄ‚îÄ ui-helpers.ts       # ChatInputHelpers, etc.
‚îú‚îÄ‚îÄ fixtures/               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ ai/                 # AI fixtures –¥–ª—è replay
‚îÇ   ‚îú‚îÄ‚îÄ worlds/             # World definitions
‚îÇ   ‚îî‚îÄ‚îÄ files/              # –§–∞–π–ª—ã –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
```

### –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

#### API Testing

```typescript
// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π Direct Cookie Header Pattern
const context = await browser.newContext({
  extraHTTPHeaders: {
    'Cookie': `test-session-fallback=${sessionCookie}`
  }
})
```

#### E2E Testing

```typescript
// ‚úÖ UNIFIED: –ò—Å–ø–æ–ª—å–∑—É–π universalAuthentication() helper
import { universalAuthentication } from '../../helpers/auth.helper'

test.beforeEach(async ({ page }) => {
  const testUser = {
    email: `test-${Date.now()}@test.com`,
    id: crypto.randomUUID()
  }
  
  await universalAuthentication(page, testUser)
  console.log('‚úÖ Universal authentication completed')
})

// ‚úÖ UNIFIED: –ò—Å–ø–æ–ª—å–∑—É–π POM –∫–ª–∞—Å—Å—ã –∏–∑ tests/pages/
import { FileImportPage } from '../../pages/file-import.page'

const fileImportPage = new FileImportPage(page)
const success = await fileImportPage.performFullImportWorkflow(
  filePath, expectedFileName, expectedContent
)
```

#### Unit Testing

```typescript
// ‚úÖ –ú–æ–∫–∏—Ä—É–π –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
vi.mock('@/lib/db/connection')
vi.mock('server-only')
```

### –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å

```typescript
// ‚ùå –ò–∑–±–µ–≥–∞–π server-only –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ E2E —Ç–µ—Å—Ç–∞—Ö
import { getWorldData } from '../../helpers/worlds' // server-only

// ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —Ö—Ä—É–ø–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
await page.click('button:nth-child(3)') // –ø–ª–æ—Ö–æ
await page.getByTestId('submit-button').click() // —Ö–æ—Ä–æ—à–æ

// ‚ùå Fallback —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω—ã—Ö testid
page.locator('[data-testid*="chat-input"], textarea, input[type="text"]') // –ø–ª–æ—Ö–æ
page.getByTestId('chat-input-textarea') // —Ö–æ—Ä–æ—à–æ
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

### –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤ `.memory-bank/testing/`:

- **`api-auth-setup.md`** ‚Äî –ü–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ API –∏ E2E —Ç–µ—Å—Ç–∞—Ö
- **`three-level-testing-system.md`** ‚Äî –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ "Use Cases + Worlds + AI Fixtures"
- **`ui-testing.md`** ‚Äî –ñ–∏–≤–æ–π –ú–∞–Ω–∏—Ñ–µ—Å—Ç UI —Å —Ä–µ–µ—Å—Ç—Ä–æ–º data-testid –∏ POM –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- **`worlds-manifest.md`** ‚Äî –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö "–º–∏—Ä–æ–≤" –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–π

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:

- **UC-10 Schema-Driven CMS** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ E2E —Ç–µ—Å—Ç–∞—Ö –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ 11 —Ç–∏–ø–æ–≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **POM –∫–ª–∞—Å—Å—ã** ‚Äî SiteEditorPage, PublicationPage, ChatInputHelpers –≤ `tests/helpers/`
- **Artifact Testing** ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞

---

> **–ü—Ä–∏–Ω—Ü–∏–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è WelcomeCraft:** –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤—ã –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º UI, server-side –ø—Ä–æ–±–ª–µ–º–∞–º –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º
> —Å–±–æ—è–º. –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏
> —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –ª–æ–≥–∏–∫–æ–π.