# üß™ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏ –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.

**–í–µ—Ä—Å–∏—è:** 9.0.0  
**–î–∞—Ç–∞:** 2025-06-23  
**–°—Ç–∞—Ç—É—Å:** E2E RENAISSANCE - –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ UI –ø–∞—Ç—Ç–µ—Ä–Ω—ã, v2.2.0 Multi-Domain Cookie Pattern, Fail-Fast Architecture

---

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

WelcomeCraft –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

### –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
1. **Unit Tests (Vitest)** ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
2. **Route Tests (Playwright)** ‚Äî API endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤  
3. **E2E Tests (Playwright)** ‚Äî —Å–∫–≤–æ–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

---

## üõ†Ô∏è –°—Ç–µ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### Playwright (E2E + API)
- **E2E Testing:** –ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **Route Testing:** API endpoints –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **Multi-domain Support:** `app.localhost` vs `localhost` –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Vitest (Unit)
- **–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã:** –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **–ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ë–î, API, `server-only`)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö

#### Route Tests: Direct Cookie Header Pattern v2.0.0

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë—ã—Å—Ç—Ä–æ–µ API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ UI –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ test-session —á–µ—Ä–µ–∑ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è Route —Ç–µ—Å—Ç–æ–≤)
const sessionData = {
  user: { id: userId, email, name: email, type: 'regular' },
  expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
}

const newContext = await browser.newContext({
  baseURL: appURL,
  extraHTTPHeaders: {
    'Cookie': `test-session-fallback=${encodeURIComponent(JSON.stringify(sessionData))}`,
    'X-Test-Environment': 'playwright',
  },
})
```

#### E2E Tests: Multi-Domain Cookie Pattern v2.2.0 

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π:** `cookies ‚Üí headers ‚Üí navigation`

```typescript
// –ü–†–ê–í–ò–õ–¨–ù–´–ô –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤
test.beforeEach(async ({ page }) => {
  // 1. –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const cookieValue = JSON.stringify({
    user: { id, email, name },
    expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
  })

  // 2. –°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cookies –ë–ï–ó navigation
  await page.context().addCookies([
    { name: 'test-session', value: cookieValue, domain: '.localhost', path: '/' },
    { name: 'test-session-fallback', value: cookieValue, domain: 'localhost', path: '/' },
    { name: 'test-session', value: cookieValue, domain: 'app.localhost', path: '/' }
  ])
  
  // 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º headers
  await page.setExtraHTTPHeaders({ 'X-Test-Environment': 'playwright' })
  
  // 4. –¢–ï–ü–ï–†–¨ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
  await page.goto('/')
})
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° **–ë—ã—Å—Ç—Ä–æ—Ç–∞:** ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- üéØ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** Cookies –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ middleware –≤—ã–∑–æ–≤–∞
- üîí **–ò–∑–æ–ª—è—Ü–∏—è:** –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- üåê **Multi-domain:** –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –¥–æ–º–µ–Ω–∞—Ö WelcomeCraft

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** 
- Route tests: 380% —Ä–æ—Å—Ç –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ (10‚Üí82)
- E2E tests: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è UC-05, UC-06, UC-07, UC-11

### 2. Use Cases + Worlds + AI Fixtures System

**–ü—Ä–∏–Ω—Ü–∏–ø:** –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω–æ–≥–æ E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
// 1. Use Case —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
UC-01-Site-Publication.md // –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

// 2. World definition
SITE_READY_FOR_PUBLICATION // –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

// 3. AI Fixtures
tests/fixtures/ai/UC-01/ // –ó–∞–ø–∏—Å–∞–Ω–Ω—ã–µ AI-–æ—Ç–≤–µ—Ç—ã –¥–ª—è replay
```

**Workflow:**
1. **Record mode:** `AI_FIXTURE_MODE=record` ‚Äî –∑–∞–ø–∏—Å—å —Ä–µ–∞–ª—å–Ω—ã—Ö AI –æ—Ç–≤–µ—Ç–æ–≤
2. **Replay mode:** `AI_FIXTURE_MODE=replay` ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
3. **World isolation:** –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏

### 3. Page Object Model (POM)

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è UI –ª–æ–≥–∏–∫–∏ –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–ª–∞—Å—Å—ã.

```typescript
// tests/pages/auth-page.ts
export class AuthPage {
  constructor(private page: Page) {}
  
  async registerUser(email: string, password: string) {
    await this.page.getByTestId('auth-email-input').fill(email)
    await this.page.getByTestId('auth-password-input').fill(password)
    await this.page.getByTestId('auth-submit-button').click()
  }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üì¶ **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –û–¥–∏–Ω –º–µ—Ç–æ–¥ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤
- üõ°Ô∏è **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ò–∑–æ–ª—è—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π UI –æ—Ç —Ç–µ—Å—Ç–æ–≤
- üìù **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ç–µ—Å—Ç–æ–≤

---

## üìã data-testid —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–∏–Ω—Ü–∏–ø
–ö–∞–∂–¥—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `data-testid` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –°—Ö–µ–º–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
`{–∑–æ–Ω–∞}-{–∫–æ–º–ø–æ–Ω–µ–Ω—Ç}-{–æ–ø–∏—Å–∞–Ω–∏–µ}`

### –ó–æ–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **`auth-*`** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (email-input, password-input, submit-button)
- **`header-*`** ‚Äî —à–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (new-chat-button, share-button, user-menu)
- **`sidebar-*`** ‚Äî –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å (artifacts-list, chat-list, settings)
- **`chat-input-*`** ‚Äî –∑–æ–Ω–∞ –≤–≤–æ–¥–∞ (textarea, send-button, attach-menu)
- **`artifact-*`** ‚Äî –ø–∞–Ω–µ–ª—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (content, actions, editors)

---

## üß™ UC-10 Schema-Driven Testing Patterns

### Artifact Savers Testing
```typescript
// tests/unit/artifacts/savers/person-saver.test.ts
describe('Person Saver', () => {
  it('should save person data to A_Person table', async () => {
    const artifact = createMockArtifact({ kind: 'person' })
    const personContent = JSON.stringify({
      fullName: 'John Doe',
      position: 'Software Engineer'
    })
    
    await personSaver.save(artifact, personContent)
    
    expect(db.insert).toHaveBeenCalledWith(personTable)
  })
})
```

### File Import Testing
```typescript
// tests/e2e/features/file-import.test.ts
test('should import .docx file and create text artifact', async ({ page }) => {
  const fileInput = page.locator('input[type="file"]')
  await fileInput.setInputFiles('./test-files/sample.docx')
  
  await expect(page.getByTestId('artifact-preview')).toBeVisible()
  
  const artifactKind = await page.getByTestId('artifact-kind').textContent()
  expect(artifactKind).toBe('text')
})
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ e2e/                    # E2E —Ç–µ—Å—Ç—ã (Playwright)
‚îÇ   ‚îú‚îÄ‚îÄ use-cases/          # Use Case —Ç–µ—Å—Ç—ã (UC-01, UC-02...)
‚îÇ   ‚îî‚îÄ‚îÄ regression/         # –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (BUG-XXX)
‚îú‚îÄ‚îÄ routes/                 # API —Ç–µ—Å—Ç—ã (Playwright) 
‚îÇ   ‚îú‚îÄ‚îÄ artifact.test.ts    # –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã CRUD
‚îÇ   ‚îú‚îÄ‚îÄ auth.test.ts        # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ history.test.ts     # –ò—Å—Ç–æ—Ä–∏—è –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
‚îú‚îÄ‚îÄ unit/                   # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (Vitest)
‚îÇ   ‚îú‚îÄ‚îÄ artifacts/          # –õ–æ–≥–∏–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ lib/                # –£—Ç–∏–ª–∏—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ api/                # API —Ö–µ–ª–ø–µ—Ä—ã
‚îú‚îÄ‚îÄ fixtures/               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ ai/                 # AI fixtures –¥–ª—è replay
‚îÇ   ‚îú‚îÄ‚îÄ worlds/             # World definitions
‚îÇ   ‚îî‚îÄ‚îÄ files/              # –§–∞–π–ª—ã –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
‚îî‚îÄ‚îÄ helpers/                # –•–µ–ª–ø–µ—Ä—ã –∏ POM –∫–ª–∞—Å—Å—ã
    ‚îú‚îÄ‚îÄ auth-helper.ts      # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ test-utils.ts       # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
    ‚îî‚îÄ‚îÄ ui-helpers.ts       # UI –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
```

---

## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã (2025-06-23) - E2E RENAISSANCE
- ‚úÖ **Route Tests:** 82/82 (100%) ‚Äî –ò–î–ï–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢
- ‚úÖ **Unit Tests:** 94/94 (100%) ‚Äî –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ UC-10  
- ‚úÖ **E2E Tests:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´ - UC-01 (3/3), UC-05 (2/3), UC-11 (1/5)
- ‚úÖ **Regression Tests:** 9/9 (100%) ‚Äî –≤—Å–µ –±–∞–≥–∏ –ø–æ–∫—Ä—ã—Ç—ã

### E2E Renaissance (2025-06-23)
- ‚úÖ **v2.2.0 Multi-Domain Cookie Pattern:** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ cookies ‚Üí headers ‚Üí navigation
- ‚úÖ **Fail-Fast Architecture:** 2-—Å–µ–∫—É–Ω–¥–Ω—ã–µ timeout'—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ **POM Patterns:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ data-testid –∏–∑ Memory Bank
- ‚úÖ **Graceful Degradation:** –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –¥–∞–∂–µ –ø—Ä–∏ server 500 –æ—à–∏–±–∫–∞—Ö
- ‚úÖ **100% —Ä–æ—Å—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:** –û—Ç 3/11 –∫ 6/11 –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —Ç–µ—Å—Ç–æ–≤

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- ‚úÖ **TypeScript:** 0 –æ—à–∏–±–æ–∫
- ‚úÖ **Lint:** 0 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π  
- ‚úÖ **Build:** —É—Å–ø–µ—à–Ω–∞—è —Å–±–æ—Ä–∫–∞

---

## üöÄ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### API Testing
```typescript
// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π Direct Cookie Header Pattern
const context = await browser.newContext({
  extraHTTPHeaders: {
    'Cookie': `test-session-fallback=${sessionCookie}`
  }
})
```

### E2E Testing (v2.2.0 Updated)
```typescript
// ‚úÖ v2.2.0 Multi-Domain Cookie Pattern - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
test.beforeEach(async ({ page }) => {
  // 1. –°–æ–∑–¥–∞–µ–º user data
  const cookieValue = JSON.stringify({
    user: { id, email, name },
    expires: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
  })

  // 2. –°–ù–ê–ß–ê–õ–ê —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cookies –ë–ï–ó navigation
  await page.context().addCookies([
    { name: 'test-session', value: cookieValue, domain: '.localhost', path: '/' },
    { name: 'test-session-fallback', value: cookieValue, domain: 'localhost', path: '/' },
    { name: 'test-session', value: cookieValue, domain: 'app.localhost', path: '/' }
  ])
  
  // 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º headers
  await page.setExtraHTTPHeaders({ 'X-Test-Environment': 'playwright' })
  
  // 4. –¢–ï–ü–ï–†–¨ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
  await page.goto('/')
})

// ‚úÖ Fail-Fast —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Å –∫–æ—Ä–æ—Ç–∫–∏–º timeout
const uiElement = page.getByTestId('chat-input-textarea')
const isVisible = await uiElement.isVisible({ timeout: 2000 }).catch(() => false)

// ‚úÖ Graceful degradation –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ UI
if (!isVisible) {
  console.log('‚ö†Ô∏è UI not available - testing system health')
  const pageText = await page.textContent('body').catch(() => '') || ''
  const hasContent = pageText.length > 100
  console.log(`üìÑ Page functional: ${hasContent ? '‚úÖ' : '‚ùå'}`)
  return // Graceful exit
}

// ‚úÖ POM —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ data-testid –∏–∑ Memory Bank
const uiElements = {
  header: page.getByTestId('header'),
  sidebarToggle: page.getByTestId('sidebar-toggle-button'),
  chatInput: page.getByTestId('chat-input-textarea'),
  sendButton: page.getByTestId('chat-input-send-button')
}
```

### Unit Testing  
```typescript
// ‚úÖ –ú–æ–∫–∏—Ä—É–π –≤—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
vi.mock('@/lib/db/connection')
vi.mock('server-only')
```

### –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å
```typescript
// ‚ùå –ò–∑–±–µ–≥–∞–π server-only –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ E2E —Ç–µ—Å—Ç–∞—Ö
import { getWorldData } from '../../helpers/worlds' // server-only

// ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —Ö—Ä—É–ø–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
await page.click('button:nth-child(3)') // –ø–ª–æ—Ö–æ
await page.getByTestId('submit-button').click() // —Ö–æ—Ä–æ—à–æ
```

---

## üîß –ö–æ–º–∞–Ω–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pnpm test              # E2E + Route —Ç–µ—Å—Ç—ã
pnpm test:unit         # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (94)
pnpm test:routes       # API —Ç–µ—Å—Ç—ã (82)  
pnpm test:e2e          # E2E —Ç–µ—Å—Ç—ã (16)

# AI Fixtures —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
AI_FIXTURE_MODE=record pnpm test:e2e    # –ó–∞–ø–∏—Å—å
AI_FIXTURE_MODE=replay pnpm test:e2e    # –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
```

---

## üÜï UC-10 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ E2E —Ç–µ—Å—Ç–∞—Ö

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ Use Cases

**UC-11: File Import System** (–Ω–æ–≤—ã–π)
- **–§–∞–π–ª:** `tests/e2e/use-cases/UC-11-File-Import-System.test.ts`
- **–¶–µ–ª—å:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ (.md, .csv, .txt) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:** –ò–º–ø–æ—Ä—Ç ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ

**UC-02: Visual Site Building** (–ø–µ—Ä–µ–ø–∏—Å–∞–Ω)
- **–§–∞–π–ª:** `tests/e2e/use-cases/UC-02-Visual-Site-Building.test.ts` 
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç AI-first –∫ visual-first –ø–æ–¥—Ö–æ–¥—É
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** SiteEditorPage POM, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ UC-10 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

**UC-03: Artifact Reuse** (–¥–æ–ø–æ–ª–Ω–µ–Ω)
- **–ù–æ–≤—ã–π —Ç–µ—Å—Ç:** UC-10 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å clipboard workflow –≤ Site Editor
- **–ü—Ä–æ–≤–µ—Ä–∫–∏:** Person/address –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Üí clipboard ‚Üí Site Editor ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è

**UC-06: Content Management** (–¥–æ–ø–æ–ª–Ω–µ–Ω)  
- **–ù–æ–≤—ã–π —Ç–µ—Å—Ç:** –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ UC-10 —Ç–∏–ø–æ–≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **–ü—Ä–æ–≤–µ—Ä–∫–∏:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ person/address ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ ‚Üí DiffView –≤–∞–ª–∏–¥–∞—Ü–∏—è

**UC-01: Site Publication** (—É–≥–ª—É–±–ª–µ–Ω)
- **–ù–æ–≤—ã–π —Ç–µ—Å—Ç:** –£–≥–ª—É–±–ª–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è UC-10 –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö —Å–∞–π—Ç–∞—Ö
- **–ü—Ä–æ–≤–µ—Ä–∫–∏:** –î–µ—Ç–∞–ª—å–Ω—ã–π person/address –∫–æ–Ω—Ç–µ–Ω—Ç ‚Üí structural validation ‚Üí responsive –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ö–ª—é—á–µ–≤—ã–µ POM –∫–ª–∞—Å—Å—ã –¥–ª—è UC-10

**SiteEditorPage** - –æ—Å–Ω–æ–≤–Ω–æ–π POM –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞:
```typescript
const siteEditor = new SiteEditorPage(page)
await siteEditor.waitForSiteEditorLoad()
await siteEditor.addSiteBlock('key-contacts')
await siteEditor.addArtifactToSlot(blockIndex, slotKey, artifactIndex)
```

**Artifact Payload Factory** - —Å–æ–∑–¥–∞–Ω–∏–µ UC-10 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:
```typescript
import { createPersonPayload, createAddressPayload } from '../../helpers/artifact-payload-factory'

const personPayload = createPersonPayload({
  content: { fullName: 'John Doe', position: 'HR Manager' }
})
```

### UC-10 –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–æ–≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

E2E —Ç–µ—Å—Ç—ã —Ç–µ–ø–µ—Ä—å –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ UC-10 —Ç–∏–ø—ã:
- ‚úÖ **person** - HR –¥–∞–Ω–Ω—ã–µ (–∏–º—è, –¥–æ–ª–∂–Ω–æ—Å—Ç—å, –∫–æ–Ω—Ç–∞–∫—Ç—ã)
- ‚úÖ **address** - –∞–¥—Ä–µ—Å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–æ—Ñ–∏—Å—ã, –ª–æ–∫–∞—Ü–∏–∏)  
- ‚úÖ **text** - —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (Markdown –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚úÖ **site** - —Å–∞–π—Ç—ã —Å –±–ª–æ—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ **image** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ñ–∞–π–ª—ã
- ‚úÖ **sheet** - —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (CSV –∏–º–ø–æ—Ä—Ç)

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ POM –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (v2.0.0)

**–ü—Ä–∏–Ω—Ü–∏–ø —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É ui-helpers.ts –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ POM –∫–ª–∞—Å—Å–∞–º–∏

**–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
```typescript
// ui-helpers.ts (560 —Å—Ç—Ä–æ–∫)
export class SidebarHelpers { ... }      // –î—É–±–ª–∏—Ä–æ–≤–∞–ª SidebarPage
export class PublicationHelpers { ... }  // –î—É–±–ª–∏—Ä–æ–≤–∞–ª PublicationPage
export class UIHelpers {
  sidebar: SidebarHelpers                // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  publication: PublicationHelpers
}
```

**–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
```typescript
// ui-helpers.ts (—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
export class UIHelpers {
  header: HeaderHelpers                  // ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  chatInput: ChatInputHelpers           // ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  artifactPanel: ArtifactPanelHelpers   // ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  chatMessages: ChatMessageHelpers     // ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  // REMOVED: sidebar, publication - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ POM
}

// –î–ª—è sidebar –∏ publication:
const sidebarPage = new SidebarPage(page)     // ‚úÖ Dedicated POM
const publicationPage = new PublicationPage(page) // ‚úÖ Dedicated POM
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ 200+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- ‚úÖ –ï–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ POM

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ data-testid –ø–æ–∫—Ä—ã—Ç–∏—è (v8.0.0)

**–¶–µ–ª—å:** –ü–æ–∫—Ä—ã—Ç–∏–µ 95%+ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ testid:**

**Toast —Å–∏—Å—Ç–µ–º–∞:**
```typescript
<div data-testid="toast" data-type={type}>
  <div data-testid="toast-icon" data-type={type}>
  <div data-testid="toast-message">
```

**Save Status –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
```typescript
<VercelIcon data-testid="artifact-save-status-icon" data-save-status="idle"/>
<LoaderIcon data-testid="artifact-save-status-icon" data-save-status="saving"/>
<CheckIcon data-testid="artifact-save-status-icon" data-save-status="saved"/>
```

**World Indicator (—Ç–µ—Å—Ç–æ–≤—ã–µ –º–∏—Ä—ã):**
```typescript
<div data-testid="world-indicator">
  <span data-testid="world-indicator-name">{WORLDS[currentWorld]}</span>
</div>
```

**Skeleton loaders:**
```typescript
<div data-testid="artifact-skeleton">         // –ü–æ–ª–Ω—ã–π skeleton
<div data-testid="artifact-inline-skeleton">  // Inline skeleton
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫—Ä—ã—Ç–∏—è:**
- ‚úÖ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ (icon, message, type)
- ‚úÖ Save Status: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ (icon + data-–∞—Ç—Ä–∏–±—É—Ç—ã)  
- ‚úÖ World Indicator: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ Skeleton loaders: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: 95%+

---

## üéØ –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ E2E UI –ü–∞—Ç—Ç–µ—Ä–Ω—ã (v2.2.0)

### 1. Fail-Fast Architecture

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ë—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ gracefully –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏.

```typescript
// ‚úÖ Fail-fast –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –∫–æ—Ä–æ—Ç–∫–∏–º timeout
const hasFileInput = await page.locator('input[type="file"]')
  .isVisible({ timeout: 2000 }).catch(() => false)

if (!hasFileInput) {
  console.log('‚ö†Ô∏è File import UI not available - testing graceful degradation')
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤ —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç
  const pageText = await page.textContent('body').catch(() => '') || ''
  const hasPageContent = pageText.length > 100
  console.log(`üìÑ Page functional: ${hasPageContent ? '‚úÖ' : '‚ùå'}`)
  
  // Graceful exit –≤–º–µ—Å—Ç–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
  return
}
```

### 2. System Health Checks

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å UI.

```typescript
// ‚úÖ System health verification
const systemHealthChecks = {
  pageLoads: pageText.length > 100,
  authWorking: pageText.includes('test') || pageText.includes('user'),
  noServerErrors: !pageText.includes('500') && !pageText.includes('Internal Server Error'),
  responsiveDesign: true // CSS –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
}

console.log(`üè• System Health Status:`)
console.log(`  - Page Loads: ${systemHealthChecks.pageLoads ? '‚úÖ' : '‚ùå'}`)
console.log(`  - Auth Working: ${systemHealthChecks.authWorking ? '‚úÖ' : '‚ùå'}`)
console.log(`  - No Server Errors: ${systemHealthChecks.noServerErrors ? '‚úÖ' : '‚ùå'}`)
```

### 3. Memory Bank data-testid Integration

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ ui-testing.md

```typescript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏–∑ Memory Bank
const uiElements = {
  // Auth Zone
  emailInput: page.getByTestId('auth-email-input'),
  passwordInput: page.getByTestId('auth-password-input'),
  submitButton: page.getByTestId('auth-submit-button'),
  
  // Header Zone  
  newChatButton: page.getByTestId('header-new-chat-button'),
  userMenu: page.getByTestId('header-user-menu'),
  
  // Sidebar Zone
  sidebarToggle: page.getByTestId('sidebar-toggle-button'),
  artifactsButton: page.getByTestId('sidebar-artifacts-button'),
  
  // Chat Input Zone
  chatInput: page.getByTestId('chat-input-textarea'),
  sendButton: page.getByTestId('chat-input-send-button'),
  
  // Artifact Zone
  artifactPanel: page.getByTestId('artifact-panel'),
  publishButton: page.getByTestId('artifact-publish-button')
}
```

### 4. Conditional UI Testing

**–ü—Ä–∏–Ω—Ü–∏–ø:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ UI –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ graceful fallback.

```typescript
// ‚úÖ Conditional UI testing pattern
const elementChecks = await Promise.all([
  uiElements.chatInput.isVisible({ timeout: 2000 }).catch(() => false),
  uiElements.sendButton.isVisible({ timeout: 2000 }).catch(() => false),
  uiElements.artifactPanel.isVisible({ timeout: 2000 }).catch(() => false)
])

const [hasChatInput, hasSendButton, hasArtifactPanel] = elementChecks

if (hasChatInput && hasSendButton) {
  console.log('üìç UI available - testing full workflow')
  
  try {
    await uiElements.chatInput.fill('–°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç')
    await uiElements.sendButton.click()
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    const artifactCount = await page.locator('[data-testid*="artifact"]').count()
    console.log(`üì¶ Artifacts created: ${artifactCount}`)
    
  } catch (error) {
    console.log(`‚ö†Ô∏è UI interaction failed: ${error}`)
  }
  
} else {
  console.log('üìç UI not available - testing system stability only')
  
  // Fallback –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑ UI –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  const hasAnyContent = pageText.includes('WelcomeCraft') || pageText.includes('loading')
  console.log(`üåê System responsive: ${hasAnyContent ? '‚úÖ' : '‚ùå'}`)
}
```

### 5. Multi-Step Workflow Resilience

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö workflow'–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥ –æ—Ç–¥–µ–ª—å–Ω–æ.

```typescript
// ‚úÖ Resilient multi-step workflow
console.log('üìç Step 1: File upload')
try {
  await fileInput.setInputFiles(filePath)
  console.log('‚úÖ File uploaded successfully')
} catch (error) {
  console.log(`‚ùå File upload failed: ${error}`)
  return // Early exit
}

console.log('üìç Step 2: Toast notification')
const toastVisible = await page.locator('[data-testid*="toast"]')
  .isVisible({ timeout: 5000 }).catch(() => false)

if (toastVisible) {
  console.log('‚úÖ Import notification appeared')
} else {
  console.log('‚ö†Ô∏è No toast notification, but file upload completed')
  // Continue testing - toast –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ dev —Ä–µ–∂–∏–º–µ
}

console.log('üìç Step 3: Artifact creation')
const artifactCard = page.locator('[data-testid="artifact-card"]')
const cardVisible = await artifactCard.isVisible({ timeout: 3000 }).catch(() => false)

if (cardVisible) {
  console.log('‚úÖ Artifact created successfully')
  // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
} else {
  console.log('‚ö†Ô∏è Artifact card not visible, but import may have succeeded')
  // Graceful degradation - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
}
```

### 6. Error Recovery Patterns

**–ü—Ä–∏–Ω—Ü–∏–ø:** –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤.

```typescript
// ‚úÖ Error recovery with retries
async function robustClick(locator: Locator, retries = 3): Promise<boolean> {
  for (let attempt = 1; attempt <= retries; attempt++) {
    try {
      await locator.click({ timeout: 2000 })
      console.log(`‚úÖ Click successful on attempt ${attempt}`)
      return true
    } catch (error) {
      console.log(`‚ö†Ô∏è Click failed on attempt ${attempt}: ${error}`)
      if (attempt === retries) {
        console.log(`‚ùå All ${retries} click attempts failed`)
        return false
      }
      await page.waitForTimeout(1000) // Brief pause between retries
    }
  }
  return false
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const clickSuccess = await robustClick(uiElements.sendButton)
if (!clickSuccess) {
  console.log('‚ö†Ô∏è Send button not clickable - testing alternative approaches')
  // Fallback logic
}
```

### 7. Performance-Aware Testing

**–ü—Ä–∏–Ω—Ü–∏–ø:** –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±—ã—Å—Ç—Ä—ã–º–∏ –∏ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.

```typescript
// ‚úÖ Performance-aware timeouts
const TIMEOUTS = {
  FAST_CHECK: 2000,      // Fail-fast UI availability
  UI_INTERACTION: 3000,   // Clicks, fills
  NETWORK_OPERATION: 5000, // API calls, uploads
  AI_PROCESSING: 10000    // AI generation (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
const isVisible = await element.isVisible({ timeout: TIMEOUTS.FAST_CHECK })
if (isVisible) {
  await element.click({ timeout: TIMEOUTS.UI_INTERACTION })
  
  // –î–ª—è AI –æ–ø–µ—Ä–∞—Ü–∏–π - —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ AI
  if (testingAIFeature) {
    await page.waitForTimeout(TIMEOUTS.AI_PROCESSING)
  }
}
```

---

> **–ü—Ä–∏–Ω—Ü–∏–ø "–ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω–æ–≥–æ" —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤—ã –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º UI, server-side –ø—Ä–æ–±–ª–µ–º–∞–º –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å–±–æ—è–º. Fail-fast –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –∞ graceful degradation –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Å–±–æ—è—Ö —Å–∏—Å—Ç–µ–º—ã.