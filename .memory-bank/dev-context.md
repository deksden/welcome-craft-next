# üë®‚Äçüíª`.memory-bank/dev-context.md`: –ö–æ–Ω—Ç–µ–∫—Å—Ç –¢–µ–∫—É—â–µ–π –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## HISTORY:

* v2.0.0 (2025-06-12): –§–æ–∫—É—Å —Å–º–µ—â–µ–Ω –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–π—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.
* v1.0.0 (2025-06-10): –ù–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è, —Ñ–æ–∫—É—Å –Ω–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

## 1. –ù–µ–¥–∞–≤–Ω–∏–µ –∫–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã:**
- –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–æ–¥ –ø–æ–Ω—è—Ç–∏–µ–º "–ê—Ä—Ç–µ—Ñ–∞–∫—Ç" 
- –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AI –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- Redis clipboard —Å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –∫–∞–∫ —É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞

**–ù–µ–¥–∞–≤–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (2025-06-14):**
- –ò–∑–º–µ–Ω–µ–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ Redis –±—É—Ñ–µ—Ä–∞: `getAndClearArtifactFromClipboard` ‚Üí `getArtifactFromClipboard` + `clearArtifactFromClipboard`
- –¢–µ–ø–µ—Ä—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö —á–∞—Ç–æ–≤ (–∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω—ã–π –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞)
- –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã –≤ UI
- **–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è "document" –≤ –ø–æ–ª—å–∑—É "artifact"
  - `document-skeleton.tsx` ‚Üí `artifact-skeleton.tsx` 
  - `document.tsx` ‚Üí `artifact-tool-results.tsx`
  - –£–¥–∞–ª–µ–Ω —É—Å—Ç–∞—Ä–µ–≤—à–∏–π API `/api/chat/discuss-artifact/` (–∑–∞–º–µ–Ω–µ–Ω Redis clipboard)

## 2. –¢–µ–∫—É—â–∏–π —Ñ–æ–∫—É—Å

**–û—Å–Ω–æ–≤–Ω–∞—è –§–∞–∑–∞ 2 –ó–ê–í–ï–†–®–ï–ù–ê:** –í—Å—è –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–π—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–§–∞–∑–∞ 3 –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–ê:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ—à–µ–Ω—ã, –≤—Å–µ route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (71/71). 

**‚úÖ –†–ï–®–ï–ù–´ –í–°–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–∞–º–∏!** Async config Playwright'–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `PLAYWRIGHT_PORT` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–µ—Ç –±–æ–ª—å—à–µ –≤–∏—Å—è—á–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö
- ‚úÖ **–†–ï–®–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê –° –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ï–ô!** –°–æ–∑–¥–∞–Ω custom test auth middleware, –æ–±—Ö–æ–¥—è—â–∏–π Auth.js v5 —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ **–†–ï–®–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê –° UUID!** PostgreSQL —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π UUID, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å `"test-user-id"` –Ω–∞ `"00000000-0000-0000-0000-000000000000"`
- ‚úÖ API route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å –Ω–æ–≤—ã–º –ø–æ–¥—Ö–æ–¥–æ–º (9/9 artifacts —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏)
- ‚úÖ –£–±—Ä–∞–Ω–æ debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ–¥–µ–Ω—ã lint + typecheck

**–û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (2025-06-15, 20:44):**
- ‚úÖ **files-upload.test.ts** - –ò–°–ü–†–ê–í–õ–ï–ù–ê –õ–û–ì–ò–ö–ê: —Ç–µ—Å—Ç –æ–∂–∏–¥–∞–ª –æ—à–∏–±–∫—É 400/500, –Ω–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ API –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 (–∑–∞–≥–ª—É—à–µ–Ω)
- ‚úÖ **redis-clipboard.test.ts** - –ò–°–ü–†–ê–í–õ–ï–ù–ê JSON-–ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º–∞: Drizzle –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç JSON –∏–∑ –ë–î
- ‚úÖ **artifact.test.ts: 9/9 passed (49.6s)** - –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ
- ‚úÖ **–í—Å–µ route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: 71/71** - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

**–û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏ (–æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):**
- E2E —Ç–µ—Å—Ç—ã –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã –∏–∑-–∑–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ AI workflow (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

## 3. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –∏ –ø–ª–∞–Ω —Ä–∞–±–æ—Ç

**üéâ –í–°–ï –ó–ê–î–ê–ß–ò –ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù–´!**

**‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤—ã—Ö —Ñ–∏—á**

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ—Ä—Ç–∞–º–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π** 
- ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–û:** Async config Playwright'–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PLAYWRIGHT_PORT`
- ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û:** –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –Ω–µ—Ç –≤–∏—Å—è—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö
- ‚úÖ **–†–ï–®–ï–ù–û:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π cookies –º–µ–∂–¥—É browser –∏ API contexts –≤ Playwright  
- ‚úÖ **–†–ï–®–ï–ù–û:** –°–æ–∑–¥–∞–Ω custom test auth middleware, –æ–±—Ö–æ–¥—è—â–∏–π Auth.js v5 –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ **–†–ï–®–ï–ù–û:** PostgreSQL UUID –ø—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û:** API route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ (71/71 –ø—Ä–æ—Ö–æ–¥—è—Ç)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ–∫—Ä—ã—Ç–∏–µ Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**
- ‚úÖ **–°–û–ó–î–ê–ù–û:** –¢–µ—Å—Ç—ã –¥–ª—è `copyArtifactToClipboard` / `getArtifactFromClipboard` + `clearArtifactFromClipboard`
- ‚úÖ **–ü–û–ö–†–´–¢–û:** –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Redis clipboard

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è**
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–´:** –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ route —Ç–µ—Å—Ç–∞—Ö
- ‚úÖ **–†–ï–®–ï–ù–´:** Drizzle JSON –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –∏ —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –ª–æ–≥–∏–∫–∞
- ‚úÖ **–†–ï–ó–£–õ–¨–¢–ê–¢:** 71/71 route —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

**‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: E2E –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ - –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û**

**üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ò–ù–°–ê–ô–¢:** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å E2E —Ç–µ—Å—Ç–∞–º–∏ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

**‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ E2E —Ç–µ—Å—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç test auth):**
- ‚úÖ **simple-test.test.ts** (1/1 passed, 37.3s) - –±–∞–∑–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ test auth
- ‚úÖ **basic-chat.test.ts** (2/2 passed, 52.1s) - —á–∞—Ç —Å test auth system
- ‚úÖ **auth-test.test.ts** (1/1 passed, 26.3s) - –ø—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ test auth API

**‚ùå –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ E2E —Ç–µ—Å—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç Auth.js):**  
- ‚ùå **session.test.ts** - hardcoded –ø–æ—Ä—Ç—ã (3000 vs –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π 3004), –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω—ã–µ redirect –ø—Ä–æ–±–ª–µ–º—ã
- ‚ùå **chat.test.ts** - –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ chat-input (redirect –Ω–∞ login –±–µ–∑ auth)
- ‚ùå **artifacts.test.ts** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- ‚ö†Ô∏è **ai-first-workflow.test.ts** - —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π (Auth.js + test auth mix)

**üî• –ö–õ–Æ–ß–ï–í–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:** –°—Ç–∞—Ä—ã–µ E2E —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π Auth.js flow (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/login), –∫–æ—Ç–æ—Ä—ã–π –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π (app.localhost vs localhost redirect loops).

## 4. –í–∞–∂–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

-   **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å ‚Äî –∫–ª—é—á:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "–ø–ª–∞–≥–∏–Ω–æ–≤" –¥–ª—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏ –±–ª–æ–∫–æ–≤ —Å–∞–π—Ç–∞ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º—É –≤ –±—É–¥—É—â–µ–º.
-   **–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∞–π—Ç–∞ –≤ `site-blocks/` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–æ–ª—å–∫–æ –æ—Ç API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
-   **JSON –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã:** `SiteDefinition` (JSON –≤ –ø–æ–ª–µ `content` –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞-—Å–∞–π—Ç–∞) —è–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–∞–≤–¥—ã –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

## 5. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–∫–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é (2025-06-15)

**üî• –ù–ï–û–ß–ï–í–ò–î–ù–û–ï –¥–ª—è AI –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**

1. **Auth.js v5 + PostgreSQL + Playwright = –ø—Ä–æ–±–ª–µ–º–∞:**
   - Auth.js v5 –Ω–µ —Å–æ–∑–¥–∞–µ—Ç session tokens –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ
   - PostgreSQL —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π UUID —Ñ–æ—Ä–º–∞—Ç –¥–ª—è user_id
   - –†–µ—à–µ–Ω–∏–µ: custom test auth middleware —Å –≤–∞–ª–∏–¥–Ω—ã–º UUID

2. **Playwright async config –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑:**
   - –ö–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ—Ä—Ç
   - –†–µ—à–µ–Ω–∏–µ: `PLAYWRIGHT_PORT` environment variable –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

3. **–ú—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Cookies –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –º–µ–∂–¥—É `app.localhost` –∏ `localhost` 
   - –†–µ—à–µ–Ω–∏–µ: —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ –≤ —Ç–µ—Å—Ç–∞—Ö

4. **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ vs Production API –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
   - API –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–≥–ª—É—à–µ–Ω—ã –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, files/upload)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ `X-Test-Environment === 'playwright'` –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ
   - –†–µ—à–µ–Ω–∏–µ: —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –∑–∞–≥–ª—É—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

5. **Drizzle ORM JSON –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥:**
   - –ü–æ–ª–µ `json('content').$type<string>()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç JSON –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑ –ë–î
   - –õ–∏—à–Ω–∏–π `JSON.parse()` –≤ —Ç–µ—Å—Ç–∞—Ö –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ –æ–±—ä–µ–∫—Ç

6. **–ú—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ vs E2E —Ç–µ—Å—Ç—ã (2025-06-15):**
   - Auth.js redirect'—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–µ–∂–¥—É app.localhost –∏ localhost
   - –°—Ç–∞—Ä—ã–µ E2E —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π Auth.js flow, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç
   - –†–µ—à–µ–Ω–∏–µ: –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ E2E —Ç–µ—Å—Ç—ã –Ω–∞ test auth —Å–∏—Å—Ç–µ–º—É

**üí° –ü–ê–¢–¢–ï–†–ù –†–ï–®–ï–ù–ò–Ø –¥–ª—è Auth –≤ —Ç–µ—Å—Ç–∞—Ö:**
- `/api/test/auth-signin` —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π JSON session cookie
- `lib/test-auth.ts` —á–∏—Ç–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ sessions
- –í—Å–µ API routes –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç dual auth: `auth()` fallback –Ω–∞ `getTestSession()`
- –ö—Ä–∏—Ç–∏—á–Ω–æ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π UUID –¥–ª—è PostgreSQL

**üí° –ü–ê–¢–¢–ï–†–ù –†–ï–®–ï–ù–ò–Ø –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test auth —Å–∏—Å—Ç–µ–º—É (simple-test, basic-chat, auth-test)
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –ù–∞—Å—Ç–æ—è—â–∏–π Auth.js flow –≤ E2E —Ç–µ—Å—Ç–∞—Ö (–º–µ–¥–ª–µ–Ω–Ω–æ, –ø—Ä–æ–±–ª–µ–º—ã —Å redirect'–∞–º–∏)
- üîß **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `tests/helpers/test-config.ts` –¥–ª—è –ø–æ—Ä—Ç–æ–≤/–¥–æ–º–µ–Ω–æ–≤
- üìê **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ URL:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ hardcode –ø–æ—Ä—Ç—ã –≤ —Ç–µ—Å—Ç–∞—Ö

**üí° –ü–ê–¢–¢–ï–†–ù –†–ï–®–ï–ù–ò–Ø –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã:**
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ API –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ vs production
- –£—á–∏—Ç—ã–≤–∞—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –∏ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥ –≤ —Ç–µ—Å—Ç–∞—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö
