# ü§ñ AI Lessons Learned

**–í–µ—Ä—Å–∏—è:** 2.0.0
**–î–∞—Ç–∞:** 2025-06-15

### HISTORY:
* v2.0.0 (2025-06-15): **–î–û–ë–ê–í–õ–ï–ù–´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–†–û–ö–ò:** Auth.js v5 + PostgreSQL + custom test auth middleware, UUID –ø—Ä–æ–±–ª–µ–º—ã.
* v1.1.0 (2025-06-13): –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Playwright, –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö –ø–æ—Ä—Ç–æ–≤ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è—Ö.
* v1.0.0 (2025-06-14): –ü–µ—Ä–≤—ã–µ —É—Ä–æ–∫–∏ –∏–∑ —Å–µ—Å—Å–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Playwright —Ç–µ—Å—Ç–æ–≤.

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–∂–Ω—ã–µ —É—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã –¥–ª—è AI –∏ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –≤ –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏—è—Ö.

---

## üåê –ú—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!

### ‚ùå –ß—Ç–æ –±—ã–ª–æ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ:
1. **–†–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤**
   - AI –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –¥–æ–º–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
   - –ù–µ –ø–æ–Ω–∏–º–∞–ª, —á—Ç–æ API routes –≥–ª–æ–±–∞–ª—å–Ω—ã–µ, –Ω–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç app –ø–æ–¥–¥–æ–º–µ–Ω–∞

2. **Playwright –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**
   - AI –Ω–µ —Å—Ä–∞–∑—É –ø–æ–Ω—è–ª, —á—Ç–æ –Ω—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ baseURL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
   - –ü—É—Ç–∞–ª—Å—è –º–µ–∂–¥—É localhost:3000 –∏ app.localhost:3000

3. **WebServer ping endpoint**
   - AI –Ω–µ –ø–æ–Ω–∏–º–∞–ª, —á—Ç–æ ping –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–æ–º–µ–Ω–µ
   - Middleware –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤ /site, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ:

```
Development –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
‚îú‚îÄ‚îÄ localhost:3000 (–æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ /api/* - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ API routes
‚îÇ   ‚îú‚îÄ‚îÄ /ping - health check endpoint  
‚îÇ   ‚îî‚îÄ‚îÄ /site/* - –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îî‚îÄ‚îÄ app.localhost:3000 (–ø–æ–¥–¥–æ–º–µ–Ω –∞–¥–º–∏–Ω–∫–∏)
    ‚îú‚îÄ‚îÄ /app/* - –∞–¥–º–∏–Ω–∫–∞ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
    ‚îî‚îÄ‚îÄ /api/* - —Ç–µ –∂–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ API routes
```

### üìù Playwright –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```ts
// playwright.config.ts
projects: [
  {
    name: 'e2e', // E2E —Ç–µ—Å—Ç—ã –î–û–õ–ñ–ù–´ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å app –ø–æ–¥–¥–æ–º–µ–Ω
    use: { baseURL: 'http://app.localhost:3000' }
  },
  {
    name: 'routes', // API —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω
    use: { baseURL: 'http://localhost:3000' }
  }
]
```

---

## üîß Next.js Configuration Gotchas

### ‚ùå –ß—Ç–æ –±—ã–ª–æ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ:
- `serverComponentsExternalPackages` —É—Å—Ç–∞—Ä–µ–ª–æ –∏ –ø–µ—Ä–µ–µ—Ö–∞–ª–æ –≤ `experimental.serverExternalPackages` –ø–æ—Ç–æ–º –≤ `serverExternalPackages`
- AI –ø–æ—Ç—Ä–∞—Ç–∏–ª –≤—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
```ts
// next.config.ts
const nextConfig: NextConfig = {
  // PPR –∑–∞–º–µ–¥–ª—è–µ—Ç dev server, –æ—Ç–∫–ª—é—á–∞–µ–º –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  experimental: { ppr: process.env.NODE_ENV === 'production' },
  serverExternalPackages: ['pino'], // –ù–ï –≤ experimental!
}
```

---

## üöÄ Playwright Performance & Debugging

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–ª–µ–∫–∞–ª–∏:
1. **–ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞** - AI –¥—É–º–∞–ª, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **Timeout errors** - AI —É–≤–µ–ª–∏—á–∏–≤–∞–ª —Ç–∞–π–º–∞—É—Ç—ã –≤–º–µ—Å—Ç–æ —Ä–µ—à–µ–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–æ–±–ª–µ–º—ã
3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ—Ä—Ç–æ–≤ (EADDRINUSE)** - AI –Ω–µ —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä–∏–ª, —á—Ç–æ –ø–æ—Ä—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç—ã –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
1. **–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** - –¥–æ–º–µ–Ω—ã, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
2. **–ü–æ—Ç–æ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞** - –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ—Ä—Ç–æ–≤, health-check endpoint.
3. **–ò —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —Ç–∞–π–º–∞—É—Ç—ã, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤.
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** API endpoints.

### ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞ (–Ω–æ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã)

#### –ß—Ç–æ –∑–∞–º–µ–¥–ª—è–ª–æ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
1.  **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤:** `EADDRINUSE` –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª –∑–∞–ø—É—Å–∫, –µ—Å–ª–∏ –ø–æ—Ä—Ç 3000 –±—ã–ª –∑–∞–Ω—è—Ç.
2.  **–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–æ–≤:** 8 –≤–æ—Ä–∫–µ—Ä–æ–≤ –Ω–∞ CI —Å–æ–∑–¥–∞–≤–∞–ª–∏ contention –≤ dev-—Ä–µ–∂–∏–º–µ.
3.  **–ë–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç:** 120 —Å–µ–∫—É–Ω–¥ –º–∞—Å–∫–∏—Ä–æ–≤–∞–ª–∏ —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É, –∞ –Ω–µ —Ä–µ—à–∞–ª–∏ –µ–µ.
4.  **PPR (Partial Prerendering):** –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ñ–∏—á–∞ –∑–∞–º–µ–¥–ª—è–ª–∞ dev-—Å–µ—Ä–≤–µ—Ä.
5.  **Ping —á–µ—Ä–µ–∑ middleware:** `/ping` –ø—Ä–æ—Ö–æ–¥–∏–ª —á–µ—Ä–µ–∑ middleware rewrite, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–ª–æ –∑–∞–¥–µ—Ä–∂–∫—É.

#### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```typescript
// playwright.config.ts
export default defineConfig({
  // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
  workers: process.env.CI ? 2 : 1, 
  // –£–º–µ–Ω—å—à–∞–µ–º —Ç–∞–π–º–∞—É—Ç, —Ç–∞–∫ –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ
  timeout: 60 * 1000, 
  webServer: {
    // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –Ω–∞—à–ª–∏
    command: `pnpm dev --port ${portConfig.port}`,
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º /api/ping –¥–ª—è –ø—Ä—è–º–æ–≥–æ, –±—ã—Å—Ç—Ä–æ–≥–æ health-check
    url: portConfig.pingURL,
    reuseExistingServer: !process.env.CI,
  },
});

// next.config.ts  
const nextConfig: NextConfig = {
  // –û—Ç–∫–ª—é—á–∞–µ–º PPR –≤ dev/test –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞
  experimental: { ppr: process.env.NODE_ENV === 'production' },
  // ...
};
```

#### üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ):
-   **–ë–´–õ–û:** >2 –º–∏–Ω—É—Ç—ã –∑–∞–ø—É—Å–∫, —á–∞—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è –∏–∑-–∑–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–æ—Ä—Ç–æ–≤.
-   **–°–¢–ê–õ–û:** ~20-30 —Å–µ–∫—É–Ω–¥ –ø–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (—Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã).

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –±—É–¥—É—â–∏—Ö —Å–µ—Å—Å–∏–π

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Playwright —Ç–µ—Å—Ç–∞–º–∏:

1.  ‚úÖ –ü—Ä–æ—á–∏—Ç–∞—Ç—å `tech-context.md` –∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–æ –º—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ç–µ—Å—Ç–æ–≤.
2.  ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `playwright.config.ts` –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç.
3.  ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `webServer.url` –≤ –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä—è–º–æ–π API endpoint (`/api/ping`), –∞ –Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ø—Ä–æ—Ö–æ–¥—è—â—É—é —á–µ—Ä–µ–∑ middleware.
4.  ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤ `next.config.ts` –æ—Ç–∫–ª—é—á–µ–Ω—ã —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ –¥–ª—è `dev` –∏ `test` –æ–∫—Ä—É–∂–µ–Ω–∏–π.
5.  ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API endpoints –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `curl`, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è –≤ –∏—Ö —Ä–∞–±–æ—Ç–µ.
6.  ‚úÖ –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å –ª–æ–≥–∏–∫–æ–π —Å–∞–º–∏—Ö —Ç–µ—Å—Ç–æ–≤.

**–ü–û–ú–ù–ò:** –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç. –°–Ω–∞—á–∞–ª–∞ —á–∏–Ω–∏–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –ø–æ—Ç–æ–º —Å—Ç–µ–Ω—ã.
–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—Ä—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–Ω—è—Ç, –∏ –¥–µ–ª–∞—Ç—å —ç—Ç–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Ä–∞–Ω—å—à–µ.

---

## üîê Auth.js v5 + PostgreSQL + Testing (2025-06-15)

### ‚ùå –°–ê–ú–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ—Å—Ç–∏:

1. **Auth.js v5 –Ω–µ —Å–æ–∑–¥–∞–µ—Ç session tokens –≤ Playwright —Å—Ä–µ–¥–µ:**
   - –û–±—ã—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã —á–µ—Ä–µ–∑ `auth()` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `null` –≤ —Ç–µ—Å—Ç–∞—Ö
   - –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ session –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ API
   - –ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ cookies, –∞ –≤ —Å–∞–º–æ–º Auth.js v5

2. **PostgreSQL —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π UUID —Ñ–æ—Ä–º–∞—Ç:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `"test-user-id"` –≤ –∫–∞—á–µ—Å—Ç–≤–µ user_id –≤—ã–∑—ã–≤–∞–µ—Ç 400 –æ—à–∏–±–∫–∏
   - PostgreSQL —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π UUID: `"00000000-0000-0000-0000-000000000000"`
   - –≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ DB

3. **–ú—É–ª—å—Ç–∏-–¥–æ–º–µ–Ω–Ω—ã–µ cookies –≤ —Ç–µ—Å—Ç–∞—Ö:**
   - Cookies, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞ `app.localhost:3000`, –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è `localhost:3000`
   - –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–æ –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ –≤ —Ç–µ—Å—Ç–∞—Ö —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É

### ‚úÖ –†–ê–ë–û–ß–ï–ï –†–ï–®–ï–ù–ò–ï (Custom Test Auth Middleware):

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **`/api/test/auth-signin/route.ts`** - –¢–µ—Å—Ç–æ–≤—ã–π endpoint –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. **`lib/test-auth.ts`** - Middleware –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö sessions
3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ API routes** - Dual auth support

#### –ü–∞—Ç—Ç–µ—Ä–Ω:
```typescript
// –í –∫–∞–∂–¥–æ–º –∑–∞—â–∏—â–µ–Ω–Ω–æ–º API route:
let session = await auth()
if (!session?.user) {
  session = await getTestSession()
}
if (!session?.user?.id) {
  return new ChatSDKError('unauthorized:api', 'User not authenticated.').toResponse()
}
```

#### –ö–ª—é—á–µ–≤—ã–µ –¥–µ—Ç–∞–ª–∏:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π UUID: `'00000000-0000-0000-0000-000000000000'`
- JSON session cookie –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ test environment —á–µ—Ä–µ–∑ headers –∏ env variables
- –°–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å Auth.js —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ session

### üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –í—Å–µ API route —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (9/9 artifacts tests)
- ‚úÖ –û–±—Ö–æ–¥ Auth.js v5 —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π
- ‚úÖ PostgreSQL —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã