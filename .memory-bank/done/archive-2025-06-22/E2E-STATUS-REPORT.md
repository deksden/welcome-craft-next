# üìä E2E Tests Status Report

**–î–∞—Ç–∞:** 2025-06-22  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞, ‚ùå –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. E2E Authentication - Direct Cookie Header Pattern –†–ê–ë–û–¢–ê–ï–¢

**–ü—Ä–æ–±–ª–µ–º–∞:** E2E —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é middleware  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–µ–Ω Direct Cookie Header Pattern (–∫–∞–∫ –≤ —É—Å–ø–µ—à–Ω—ã—Ö route —Ç–µ—Å—Ç–∞—Ö)

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**
- ‚úÖ `‚úÖ Test session token created for: e2e-test-...` –≤ –ª–æ–≥–∞—Ö middleware
- ‚úÖ –ù–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ `/login` - URL –æ—Å—Ç–∞–µ—Ç—Å—è `http://app.localhost:3003/`
- ‚úÖ Middleware –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç `test-session-fallback` cookie

**–°–æ–∑–¥–∞–Ω–æ:**
- `tests/e2e-fixtures.ts` - –Ω–æ–≤—ã–µ E2E fixtures —Å Direct Cookie Header Pattern
- `tests/helpers/e2e-auth-helper.ts` - helper –¥–ª—è E2E –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `tests/e2e/debug/e2e-auth-test.test.ts` - debug —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–π SidebarPage POM

**–ü—Ä–æ–±–ª–µ–º–∞:** `sidebar-all-artifacts-button` –Ω–µ –Ω–∞–π–¥–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è —Å–µ–∫—Ü–∏–∏)  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `ensureArtifactsSectionExpanded()` –≤ SidebarPage

## ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

### Server-Only Modules –Ω–∞ Client-Side

**–ü—Ä–æ–±–ª–µ–º–∞:** –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–∞–¥–∞–µ—Ç —Å 500 –æ—à–∏–±–∫–æ–π  
**–ü—Ä–∏—á–∏–Ω–∞:** Server-only –º–æ–¥—É–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ

**–û—à–∏–±–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã:**
```
./lib/ai/summarizer.ts:15:1 - import 'server-only'
./lib/db/index.ts:14:1 - import 'server-only'  
./lib/db/queries.ts:19:1 - import 'server-only'
./lib/db/world-context.ts:13:1 - import { cookies } from 'next/headers'
```

**–û—à–∏–±–∫–∞:** `You're importing a component that needs "server-only". That only works in a Server Component`

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è E2E —Ç–µ—Å—Ç–æ–≤ —Å–µ–π—á–∞—Å

1. **–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ E2E —Ç–µ—Å—Ç—ã** –Ω–∞ –Ω–æ–≤—ã–π e2eTest fixtures –∏–∑ `tests/e2e-fixtures.ts`
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SidebarPage POM** —Å –Ω–æ–≤—ã–º –º–µ—Ç–æ–¥–æ–º `ensureArtifactsSectionExpanded()`

### –î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã

1. **–†–∞–∑–¥–µ–ª–∏—Ç—å server –∏ client –∫–æ–¥** –≤ lib/ai/ –∏ lib/db/
2. **–°–æ–∑–¥–∞—Ç—å API routes** –¥–ª—è server-only –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–£–±—Ä–∞—Ç—å –ø—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã** server-only –º–æ–¥—É–ª–µ–π –∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üß™ –°—Ç–∞—Ç—É—Å E2E —Ç–µ—Å—Ç–æ–≤

- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç (Direct Cookie Header Pattern)
- ‚ùå **UI —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ server-side –æ—à–∏–±–∫–∞–º–∏
- ‚ö†Ô∏è **data-testid:** –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º UI (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É —Å server-only –º–æ–¥—É–ª—è–º–∏
2. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ E2E —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ–≤—ã–µ fixtures
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ data-testid –≤ —Ä–∞–±–æ—Ç–∞—é—â–µ–º UI
4. –£–¥–∞–ª–∏—Ç—å debug —Ñ–∞–π–ª—ã: `tests/e2e/debug/`

---

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** E2E –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞, –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.