# üîÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: World cookies –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ PRODUCTION —Ä–µ–∂–∏–º

**ID:** BUG-010  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** 2025-06-18  
**–°–≤—è–∑–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞:** `.memory-bank/buglog.md#BUG-010`  
**üåç –¢–µ—Å—Ç–æ–≤—ã–µ –º–∏—Ä—ã:** `PRODUCTION` + —Ç–µ—Å—Ç–æ–≤—ã–µ –º–∏—Ä—ã (`CLEAN_USER_WORKSPACE`, `ENTERPRISE_ONBOARDING`)  
**üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞:** –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã–µ –¢–µ—Å—Ç—ã (POM + World isolation + Cookie validation)

---

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

World cookies –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ PRODUCTION —Ä–µ–∂–∏–º –∏ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–∏—Ä –≤–º–µ—Å—Ç–æ –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º–∞.

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Ö–æ–¥ –≤ PRODUCTION —Ä–µ–∂–∏–º

#### –î–∞–Ω–æ:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–µ—Å—Ç–æ–≤—ã–µ –º–∏—Ä—ã
- –í –±—Ä–∞—É–∑–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã world cookies (–Ω–∞–ø—Ä–∏–º–µ—Ä, `world_id=CLEAN_USER_WORKSPACE`)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª–æ–≥–∏–Ω–∞ `/login`

#### –ö–æ–≥–¥–∞:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç credentials
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ä–µ–∂–∏–º `PRODUCTION` –≤ world selector
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Sign in"
4. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω—ã–π –ª–æ–≥–∏–Ω

#### –¢–æ–≥–¥–∞ (–û–∂–∏–¥–∞–µ–º–æ–µ):
- World cookies –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞—é—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏—Å—Ç–∏–Ω–Ω–æ–º PRODUCTION —Ä–µ–∂–∏–º–µ
- World indicator –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI

#### –ê (–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ):
- World cookies –æ—Å—Ç–∞—é—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∏—Ä–µ
- –°–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç —Å–µ–±—è –∫–∞–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: Logout

#### –î–∞–Ω–æ:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –º–∏—Ä–µ
- World cookies —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –≥–ª–∞–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

#### –ö–æ–≥–¥–∞:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "Sign out"
3. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç logout –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`

#### –¢–æ–≥–¥–∞ (–û–∂–∏–¥–∞–µ–º–æ–µ):
- –í—Å–µ world cookies –æ—á–∏—â–∞—é—Ç—Å—è
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ª–æ–≥–∏–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Å —á–∏—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –ê (–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ):
- World cookies –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ—Å–ª–µ logout
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ª–æ–≥–∏–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–∏—Ä

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏ world cookies –≤:
1. Server action –ª–æ–≥–∏–Ω–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ PRODUCTION —Ä–µ–∂–∏–º–∞
2. Logout –ø—Ä–æ—Ü–µ–¥—É—Ä–µ

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- Login server action
- Logout server action  
- World selector component
- Middleware –¥–ª—è world isolation

### –¢—Ä–µ–±—É–µ–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –î–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É world cookies –ø—Ä–∏ login –≤ PRODUCTION
2. –î–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É world cookies –ø—Ä–∏ logout
3. –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ world indicator

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**üîó –°–≤—è–∑–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç:** `tests/e2e/regression/010-world-cookies-cleanup.test.ts`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1. **üß™ PRODUCTION —Ä–µ–∂–∏–º:**
   - World cookies –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ PRODUCTION
   - World indicator —Å–∫—Ä—ã—Ç –≤ UI
   - –ù–µ—Ç –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–∏—Ä–∞–º

2. **üîê Logout –ø—Ä–æ—Ü–µ–¥—É—Ä–∞:**
   - –í—Å–µ world cookies –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ logout
   - –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ª–æ–≥–∏–Ω–µ –Ω–µ—Ç –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –º–∏—Ä–∞
   - –ß–∏—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–µ–∞–Ω—Å–∞

3. **üåç –¢–µ—Å—Ç–æ–≤—ã–µ –º–∏—Ä—ã:**
   - World cookies –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∏—Ä–æ–≤
   - World cookies –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ PRODUCTION
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

4. **üìã –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:**
   - –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã –ñ–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω—ã—Ö –¢–µ—Å—Ç–æ–≤
   - Fail-fast –ª–æ–∫–∞—Ç–æ—Ä—ã –¥–ª—è UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
   - –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ cookies —á–µ—Ä–µ–∑ browser API

---

> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** High - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏–∑–æ–ª—è—Ü–∏–∏ –º–∏—Ä–æ–≤