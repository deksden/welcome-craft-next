# üîÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: –ö–Ω–æ–ø–∫–∞ "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" –≤ site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞—Ö

**ID:** BUG-005  
**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–î–∞—Ç–∞:** 2025-06-18  
**–°–≤—è–∑–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞:** `.memory-bank/buglog.md#BUG-005`

---

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ —Ç–∏–ø–∞ 'site' –∫–Ω–æ–ø–∫–∞ "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π. –ü–æ –¥–∏–∑–∞–π–Ω—É —Å–∏—Å—Ç–µ–º—ã –∫–Ω–æ–ø–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¢–û–õ–¨–ö–û —É site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, –Ω–æ –æ–Ω–∞ –Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

### –î–∞–Ω–æ:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ —Å–∏—Å—Ç–µ–º–µ
- –í —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç)
- –°–∏—Å—Ç–µ–º–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- –ö–Ω–æ–ø–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¢–û–õ–¨–ö–û —É site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–ø–æ –¥–∏–∑–∞–π–Ω—É —Å–∏—Å—Ç–µ–º—ã)

### –ö–æ–≥–¥–∞:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
2. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" —Å –∏–∫–æ–Ω–∫–æ–π –≥–ª–æ–±—É—Å–∞ –≤ –ø–∞–Ω–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏–π
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü—É–±–ª–∏–∫–∞—Ü–∏—è"

### –¢–æ–≥–¥–∞ (–û–∂–∏–¥–∞–µ–º–æ–µ):
- –î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –¥–∏–∞–ª–æ–≥ SitePublicationDialog
- –í –¥–∏–∞–ª–æ–≥–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π (TTL, —Å—Ç–∞—Ç—É—Å)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é —Å–∞–π—Ç–∞
- –°—Å—ã–ª–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –ø–æ –Ω–µ–π –≤–∏–¥–µ–Ω –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç

### –ê (–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ):
- –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—Ç–∫—Ä—ã—Ç–∏—é –¥–∏–∞–ª–æ–≥–∞
- Custom event 'open-site-publication-dialog' –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –î–∏–∞–ª–æ–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:
- –°–∏—Å—Ç–µ–º–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å TTL –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- Publication System —Ä–∞–±–æ—Ç–∞–µ—Ç —Å jsonb –ø–æ–ª–µ–º `publication_state` –≤ —Ç–∞–±–ª–∏—Ü–µ Artifact
- SitePublicationDialog –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –ï—Å—Ç—å generic publication utilities: `isArtifactPublished()`, `publishSite()`, `unpublishSite()`

### –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. **Custom event –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç:** Event 'open-site-publication-dialog' –º–æ–∂–µ—Ç –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è
2. **–î–∏–∞–ª–æ–≥ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è:** SitePublicationDialog –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ DOM
3. **Event listener –ø—Ä–æ–±–ª–µ–º–∞:** useEffect –≤ artifact.tsx –º–æ–∂–µ—Ç –Ω–µ —Å–ª—É—à–∞—Ç—å event –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **State —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** isSitePublicationDialogOpen –º–æ–∂–µ—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:**
- `artifacts/kinds/site/client.tsx` - –∫–Ω–æ–ø–∫–∞ "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" –≤ actions –º–∞—Å—Å–∏–≤–µ (—Å—Ç—Ä–æ–∫–∏ 194-206)
- `components/artifact.tsx` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ custom event (—Å—Ç—Ä–æ–∫–∏ 230-241) –∏ –¥–∏–∞–ª–æ–≥ (—Å—Ç—Ä–æ–∫–∏ 327-337)
- `components/site-publication-dialog.tsx` - –¥–∏–∞–ª–æ–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–∞–π—Ç–∞

**üîó –°–≤—è–∑–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç:** `tests/e2e/regression/005-publication-button-artifacts.test.ts`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** –ö–Ω–æ–ø–∫–∞ "–ü—É–±–ª–∏–∫–∞—Ü–∏—è" —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞—Ö
2. **Custom events:** Event —Å–∏—Å—Ç–µ–º–∞ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–æ–π –∏ –¥–∏–∞–ª–æ–≥–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **UI behavior:** SitePublicationDialog –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É
4. **–¢–æ–ª—å–∫–æ site –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:** –ö–Ω–æ–ø–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¢–û–õ–¨–ö–û —É site —Ç–∏–ø–∞ (–ø–æ –¥–∏–∑–∞–π–Ω—É)

---

> **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** High - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è UX —Å–∏—Å—Ç–µ–º—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.